{% extends "base.html" %}

{% block body %}

<h1> Budget </h1>
<p>
  Some introductory text.
</p>

<script id = "inputPair"  type = "x-tmpl-mustache">
  {% raw %}
  <div class = 'form-group' id = "inputGroup{{id}}" >
    <label for='{{name}}{{id}}' class = 'col-sm-3 control-label'>
      {{name}}
    </label>
    <div class = 'col-sm-8'>
      <input  name  = '{{name}}{{id}}' 
              id    = '{{name}}{{id}}' 
              type  = 'text' 
              class = 'form-control'
              value = ""
              />
    </div>
    <label for='{{name}}{{id}}' class = 'col-sm-3 control-label'>
      {{name}} Description
    </label>
    <div class = "col-sm-8">
      <textarea class="form-control" 
                style="min-width: 100%"
                rows = "3" 
                id = "{{name}}Description"></textarea> 
    </div>
  </div>
  {% endraw %}
</script>

<div class = "row">
  <script type = "text/javascript">
    $(document).ready( function () {
      var elements = [  "Faculty Stipend", 
                        "Equipment", 
                        "Materials",
                        "Miles",
                        "Other"
                      ]

    for (var ndx = 0 ; ndx < elements.length ; ndx++ ) {
      var data = { "name" : elements[ndx], "id" : ndx };
      rendered = Mustache.render($("#inputPair").html(), data);
      $("#budgetForm").append(rendered);
            
      // This is how to select these elements now...
      // $("[id='Faculty Stipend{{1}}']").val(1000);
      }
      
    console.log("Done Appending.");  
    // End Ready
    });
    
  </script>
  
  <form id = "budgetForm"
        class = "form-horizontal col-sm-8 col-sm-offset-2">
    
  <div class = "col-md-6">
    Faculty Stipend
    <br>
    <input  onchange = "findTotal()" 
            type = "number" 
            name = "qty" 
            min = "0.01" 
            step = "0.01" 
            max = "100000" 
            id = "facStipend"/>
    <br><br>
    Equipment
    <br>
    <input  onchange = "findTotal()" 
            type = "number" 
            name = "qty" 
            min = "0.01" 
            step = "0.01" 
            max = "100000" 
            id = "equipment"/>
    <br>
    Description<br><textarea rows = "3" id = "equipmentDes"></textarea>
    <br><br>
    Materials
    <br>
    <input  onchange = "findTotal()" 
            type = "number" 
            name = "qty" 
            min = "0.01" 
            step = "0.01" 
            max = "100000" 
            id = "materials"/>
    <br>
    Description<br><textarea rows = "3" id = "materialsDes"></textarea>
    <br><br>
    Travel
    <br>
    <input  onchange = "findTotal()" 
            type = "number" 
            name = "qty" 
            min = "0.01" 
            step = "0.01" 
            max = "100000" 
            id = "travel"/>
    <br>
    Description<br><textarea rows = "3" id = "travelDes"></textarea>
    <br><br>
    Miles
    <br>
    <input type = "number" min = "0.01" step = "0.01" id = "miles"/>
    <br>
    Description<br><textarea rows = "3" id = "milesDes"></textarea>
    <br><br>
    Other
    <br>
    <input  onchange = "findTotal()" 
            type = "number" 
            name = "qty" 
            min = "0.01" 
            step = "0.01" 
            max = "100000" 
            id = "other"/>
    <br>
    Description<br><textarea rows = "3" id = "otherDes"></textarea>
    <br><br>
    Total
    <label id="total">0</label>
  </div>
  
  <script type = "text/javascript">
  
    function findTotal(){
      var arr = document.getElementsByName("qty");
      var tot=0;
      for(var i=0; i<arr.length; i++){
        if(parseInt(arr[i].value))
            tot += parseInt(arr[i].value);
      }
    document.getElementById("total").innerHTML = tot;
    console.log(tot)
    }
    
  </script>
  
{% endblock %}