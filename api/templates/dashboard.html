{% extends "base.html" %}
{% set currentPage = "dashboard" %}

{% block title %} URCPP Project Basics {% endblock %}

{% block body %}
<br/>
{% include "snips/messages.html" %}

 {% if currentCycle and currentCycle.AllSubmissionsClosedDate < today %}
   <div class = "col-lg-6">
      <h1>URCPP @ Berea College</h1>
    </div>
    <div class="col-lg-6">
      <br/>
      {% include 'snips/menu.html'%}
    </div>
    <br/>
    <div class="jumbotron">
      <h1>Hello, {{ldap.firstname}} {{ldap.lastname}}!</h1>
    </div> 
    
     <h3 class = "text-center">Submissions are now closed.</h3><h4 class = "text-center"><p>Please contact </p><p>The Current IRB Chair: <a href = "mailto:{{email_IRBchair}}">{{currentCycle.IRBchair_id.firstname}} {{currentCycle.IRBchair_id.lastname}}</a></p> 
     <p>The Current Chair: <a href = "mailto:{{email_currentchair}}">{{currentCycle.currentchair_id.firstname}} {{currentCycle.currentchair_id.lastname}} </a></p>
     <p>The Current Staff Support: <a href = "mailto:{{email_staffsupport}}">{{currentCycle.staffsupport_id.firstname}} {{currentCycle.staffsupport_id.lastname}} </a></p>
   <p>If you need additional support for your application. </p></h4>
  {% else %}<!---ALLSUBMISSIONS ARE NOT CLOSED-->
    {% if currentCycle and currentCycle.ProposalClosedDate > today %}<!--IF THE PROPOSAL DATE HAS NOT CLOSED-->
          <div class = "col-lg-6">
          <h1>URCPP @ Berea College</h1>
          </div>
          <div class="col-lg-6">
            <br/>
            {% include 'snips/menu.html'%}
          </div>
          <br/>
          <div class="jumbotron">
            <h1>Hello, {{ldap.firstname}} {{ldap.lastname}}!</h1>
            <p></p>
                
                  <a href="{% if proj %} {{ cfg['projectStatusAction'][proj.status]['url']}}{% else %}{{cfg['projectStatusAction']['Start']['url']}}{% endif %}">
                    <button class="btn btn-default">
                    <span>{% if proj %} {{ cfg['projectStatusAction'][proj.status]['msg']}}{% else %}{{cfg['projectStatusAction']['Start']['msg']}}{% endif %}</span>
                    <span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
                    </button>
                  </a>
               
          {% if proj.status != "Reject" %}<!--UPLOAD BUTTONS-->
              </a> 
                {% if proj.status == "Incomplete" or proj.status == "Pending" or proj.status == "Accept" %}
              <a href="/upload/vitae?source=home">
                <button class="btn btn-default">
                <span>Upload a Curriculum vitae</span>
                <span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>   
                </button>
              </a>
              <a href="/upload/abstract?source=home">
                <button class="btn btn-default">
                <span>Upload an Abstract</span>
                <span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
                </button>
              </a>
                {% endif %}
          {% endif %}<!---If user has not started appplication, do not show upload buttons-->
        </div>
        <div class="panel panel-default">
          <div class="panel-body">
            <div class="project-progress-bar"
              data-status="{% if proj %}{{proj.status}}{% else %}start{% endif %}">
              <div class="bar">
                <div style="width: 33%;" id="bar_fill" class="bar__fill"></div>
              </div>
              <div class="point" id="start">
                <div class="bullet"></div>
                <label class="bar-label" style="text-align: center">Start <br><small style="font-size:12px;" "text-align: center;">(Proposal Open Date: {{currentCycle.ProposalOpenDate.strftime("%Y/%m/%d")}})</small></label>
              </div>
              <div class="point" id="incomplete">
                <div class="bullet"></div>
                <label class="bar-label">Incomplete</label>
              </div>
              <div class="point" id="proposal_close_date">
                <div class="bullet"></div>
                <label class="bar-label" style="text-align: center">Proposal Panel Closes <br><small style="font-size:12px;" "text-align: center;">({{currentCycle.ProposalClosedDate.strftime("%Y/%m/%d")}})</small></label>
              </div>
              <div class="point" id="pending">
                <div class="bullet"></div>
                <label class="bar-label">Pending</label>
              </div>
              {%if proj.status == "Reject"%}
              <div class="point" id="reject">
                <div class="bullet"></div>
                <label class="bar-label" style="text-align: center">Decision Reached <br><small style="font-size:12px;" "text-align: center;">(Proposal Acceptance Date: {{currentCycle.ProposalAcceptanceDate.strftime("%Y/%m/%d")}})</small></label>
              </div>
              {% else %}
              <div class="point" id="accept">
                <div class="bullet"></div>
                <label class="bar-label" style="text-align: center">Decision Reached <br><small style="font-size:12px;" "text-align: center;">(Proposal Acceptance Date: {{currentCycle.ProposalAcceptanceDate.strftime("%Y/%m/%d")}})</small></label>
              </div>
              {% endif %}
              {% if proj.status != "Reject" %}
               <div class="point" id="abstractsubmission">
                <div class="bullet"></div>
                <label class="bar-label" style="text-align: center">Abstract Submissions <br><small style="font-size:12px;" "text-align: center;">(Due Date: {{currentCycle.AbstractnarrativesAcceptanceDate.strftime("%Y/%m/%d")}})</small></label>
              </div>
              <div class="point" id="allsubmissionscloses">
                <div class="bullet"></div>
                <label class="bar-label" style="text-align: center">All Submissions Close <br><small style="font-size:12px;" "text-align: center;">({{currentCycle.AllSubmissionsClosedDate.strftime("%Y/%m/%d")}})</small></label>
              </div>
              {% endif %}
            </div>
          </div>
        </div>
  {% else %} <!--IF PROPOSAL DATE HAS CLOSED-->
  {% if (proj.status != "Pending" and proj.status != "Accept") or proj.status == "Incomplete"  %} <!--or has not started -->
    <div class = "col-lg-6">
      <h1>URCPP @ Berea College</h1>
    </div>
    <div class="col-lg-6">
      <br/>
      {% include 'snips/menu.html'%}
    </div>
      <br/>
    <div class="jumbotron">
      <h1>Hello, {{ldap.firstname}} {{ldap.lastname}}!</h1>
    </div> 
     <h3 class = "text-center">Proposal panel is closed.</h3><h4 class = "text-center"><p>Please contact </p><p>The Current IRB Chair: <a href = "mailto:{{email_IRBchair}}">{{currentCycle.IRBchair_id.firstname}} {{currentCycle.IRBchair_id.lastname}}</a></p> 
     <p>The Current Chair: <a href = "mailto:{{email_currentchair}}">{{currentCycle.currentchair_id.firstname}} {{currentCycle.currentchair_id.lastname}} </a></p>
     <p>The Current Staff Support: <a href = "mailto:{{email_staffsupport}}">{{currentCycle.staffsupport_id.firstname}} {{currentCycle.staffsupport_id.lastname}} </a></p>
     <p>If you need additional support for your application. </p></h4>
    {% elif proj.status == "Pending" or proj.status == "Accept" %}<!--- if proposal date HAS CLOSED and project is not incomplete(aka pending, accept) render progress bar-->
         <div class = "col-lg-6">
            <h1>URCPP @ Berea College</h1>
            </div>
            <div class="col-lg-6">
              <br/>
              {% include 'snips/menu.html'%}
            </div>
            <br/>
            <div class="jumbotron">
              <h1>Hello, {{ldap.firstname}} {{ldap.lastname}}!</h1>
              <p></p>
              {% if proj.status == "Pending" or proj.status == "Accept" or proj.status == "Incomplete" %}<!---review/complete button-->
                <a href="{% if proj %} {{ cfg['projectStatusAction'][proj.status]['url']}}{% else %}{{cfg['projectStatusAction']['Start']['url']}}{% endif %}">
                  <button class="btn btn-default">
                  <span>{% if proj %} {{ cfg['projectStatusAction'][proj.status]['msg']}}{% else %}{{cfg['projectStatusAction']['Start']['msg']}}{% endif %}</span>
                  <span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
                  </button>
                </a>
              {% endif %}
            {% if proj.status != "Reject" %}<!--UPLOAD BUTTONS-->
                </a> 
                  {% if proj.status == "Incomplete" or proj.status == "Pending" or proj.status == "Accept" %}
                <a href="/upload/vitae?source=home">
                  <button class="btn btn-default">
                  <span>Upload a Curriculum vitae</span>
                  <span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>   
                  </button>
                </a>
                <a href="/upload/abstract?source=home">
                  <button class="btn btn-default">
                  <span>Upload an Abstract</span>
                  <span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span>
                  </button>
                </a>
                  {% endif %}
            {% endif %}<!---If user has not started appplication, do not show upload buttons-->
          </div>
          <div class="panel panel-default">
            <div class="panel-body">
              <div class="project-progress-bar"
                data-status="{% if proj %}{{proj.status}}{% else %}start{% endif %}">
                <div class="bar">
                  <div style="width: 33%;" id="bar_fill" class="bar__fill"></div>
                </div>
                <div class="point" id="start">
                  <div class="bullet"></div>
                  <label class="bar-label" style="text-align: center">Start <br><small style="font-size:12px;" "text-align: center;">(Proposal Open Date: {{currentCycle.ProposalOpenDate.strftime("%Y/%m/%d")}})</small></label>
                </div>
                <div class="point" id="incomplete">
                  <div class="bullet"></div>
                  <label class="bar-label">Incomplete</label>
                </div>
                <div class="point" id="proposal_close_date">
                  <div class="bullet"></div>
                  <label class="bar-label" style="text-align: center">Proposal Panel Closes <br><small style="font-size:12px;" "text-align: center;">({{currentCycle.ProposalClosedDate.strftime("%Y/%m/%d")}})</small></label>
                </div>
                <div class="point" id="pending">
                  <div class="bullet"></div>
                  <label class="bar-label">Pending</label>
                </div>
                {%if proj.status == "Reject"%}
                <div class="point" id="reject">
                  <div class="bullet"></div>
                  <label class="bar-label" style="text-align: center">Decision Reached <br><small style="font-size:12px;" "text-align: center;">(Proposal Acceptance Date: {{currentCycle.ProposalAcceptanceDate.strftime("%Y/%m/%d")}})</small></label>
                </div>
                {% else %}
                <div class="point" id="accept">
                  <div class="bullet"></div>
                  <label class="bar-label" style="text-align: center">Decision Reached <br><small style="font-size:12px;" "text-align: center;">(Proposal Acceptance Date: {{currentCycle.ProposalAcceptanceDate.strftime("%Y/%m/%d")}})</small></label>
                </div>
                {% endif %}
                {% if proj.status != "Reject" %}
                 <div class="point" id="abstractsubmission">
                  <div class="bullet"></div>
                  <label class="bar-label" style="text-align: center">Abstract Submissions <br><small style="font-size:12px;" "text-align: center;">(Due Date: {{currentCycle.AbstractnarrativesAcceptanceDate.strftime("%Y/%m/%d")}})</small></label>
                </div>
                <div class="point" id="allsubmissionscloses">
                  <div class="bullet"></div>
                  <label class="bar-label" style="text-align: center">All Submissions Close <br><small style="font-size:12px;" "text-align: center;">({{currentCycle.AllSubmissionsClosedDate.strftime("%Y/%m/%d")}})</small></label>
                </div>
                {% endif %}
              </div>
            </div>
          </div>
      {% endif %}
  {% endif %}
{% endif %}
<footer class="footer">
    <span><b>Issues? Contact:</b><a href="mailto:heggens@berea.edu"> Scott Heggen</a> </span>
</footer>
{% endblock %}