{% extends "base.html" %}
{% set currentPage = "allProjects" %}

{% block body %}

<div class="col-md-12">
  <h1 class ="col-md-6 pull-left"> Award Letters </h1>
</div>
<!--Menu-->
<ul class="nav nav-tabs">
  {% for menuItem in cfg["chair"] %}
    <li role="presentation"><a href="{{menuItem['link']}}">{{menuItem['title']}}</a></li>
  {% endfor %}
</ul>
<button data-toggle="modal" data-target="#emailModal" onclick="getLetter()" type='button' class=" text-center pull-right btn btn-default btn-sm">
  <p class="">Edit Email &nbsp
    <i class="glyphicon glyphicon-pencil"></i>
  </p>
</button>

<div class = "row">
    <table class = "table table-striped table-hover table-sm">
      <tr>
        <th>Faculty/Proj. Title</th>
        {% for column in cfg["awardLetterTable"] %}
        <th>
          {{column["title"]}}
        </th>
        {% endfor %}
      </tr>
      {% if fac is not none %}
      {% for person in fac %} <!-- See allBudgets for a better way of doing this -->
        <tr id="row{{loop.index0}}">
          <td>
            <a onclick="getProjects('{{person.username.username}}')">{{person.username.firstname}} {{person.username.lastname}}</a>
            {% if collab is not none %}
              {% for c in collab %}
                {% if person.pID == c.pID %}
                  ; <a onclick="getProjects('{{c.username.username}}')">{{c.username.firstnames}} {{c.username.lastname}}</a>
                {% endif %}
              {% endfor %}
            {% endif %}
            <span class = "small">({{person.programID.name}})</span>
            <br />
            <span class = "small">{{person.pID.title|truncate(50, True)}}</span>
      
          </td>
          {% for column in cfg["awardLetterTable"] %}
            <td name = "rowValue" class = "{{column['fieldName']}}" id="col{{loop.index0}}">
              <!--Handle dates-->
              {% if column['fieldName'] == "startDate" or column['fieldName'] == "createdDate" or column['fieldName'] == "endDate"%}  
                {% if person.pID[column['fieldName']] %}
                  {{person.pID[column['fieldName']].strftime('%m-%d-%Y')}}
                {% endif %}
              <!--Handle Funding-->
              {% elif column['fieldName'] == "stipend"%}   
                {{person.pID.budgetID.facultyStipend}}
              {% elif column['fieldName'] == "funding"%}   
                {{funding[person.pID.budgetID]}}
              <!--Handle Everything else-->
              {% elif column['fieldName'] == "email" %}
              <button type='button' onclick="getEmail('{{person.pID.pID}}', '{{person.username.username}}')" class="btn btn-default btn-md">
                <i class="glyphicon glyphicon-envelope"></i>
              </button>
              {% else %}  
                {{person.pID[column['fieldName']]}}
              {% endif %}
            </td>
          {% endfor %}
        </tr>
      {% endfor %}
      {% endif %}
    </table>
  </form>
</div>


<script src="/static/js/ext/ckeditor/ckeditor.js"></script>
<script src="/static/js/pages/awardLetters.js"></script>


{% include "snips/projectsModal.html" %}
{% include "chair/emailTemplate.html" %}
{% endblock %}