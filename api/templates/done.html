{% extends "base.html" %}

{% block title %} Review Your Application {% endblock %}

{% block body %}

<h1>Review Your Application</h1>

<p>
   How does it look, {{ldap.firstname}}?
</p>

<div class = "col-sm-8 col-sm-offset-2">
   <dl>
     <dt>Project Info</dt>
       <dd>Title: {{proj.title}}</dd>
       <dd>Start Date: {{proj.startDate}}</dd>
       <dd>Duration: {{proj.duration}} weeks</dd>
       <dd>Number of Students: {{proj.numberStudents}}</dd>
       <dd>Community Partners:
         {% if proj.hasCommunityPartner %}
           Yes 
         {% else %} 
           No 
         {% endif %}
       </dd>
       <dd>Community Service: 
         {% if proj.isServiceToCommunity %}
           Yes 
         {% else %} 
           No 
         {% endif %}
       </dd>
       <dd>Date Submitted: {{proj.createdDate}}</dd>
       {% if collabs is not none %}
       <dt>Collaborators</dt>
         {% for collaborator in collabs %}
           <dd>{{collaborator.firstname}} {{collaborator.lastname}}</dd>
         {% endfor %}
       {% endif %}
       <dt>Budget</dt>
       <dt>Faculty Stipend: ${{budg.facultyStipend}}</dt>
       <dd>Description: {{budg.facultyStipendDesc}}</dd>
       <dt>Equipment: ${{budg.equipment}}</dt>
       <dd>Description: {{budg.equipmentDesc}}</dd>
       <dt>Materials: ${{budg.materials}}</dt>
       <dd>Description: {{budg.materialsDesc}}</dd>
       <dt>Travel: ${{budg.otherTravel}}</dt>
       <dd>Description: {{budg.otherTravelDesc}}</dd>
       <dt>Mileage: {{budg.miles}} miles</dt>
       <dd>Description: {{budg.milesDesc}}</dd>
       <dt>Other: ${{budg.other}}</dt>
       <dd>Description: {{budg.otherDesc}}</dd>
   </dl>
      
  <div class = "form-group"  >
    <div class = "col-sm-offset-9 col-sm-2" 
         id = "submitButton"
         >
      <button id = "submit" 
              type = "button" 
              class="btn btn-block btn-primary"
              onClick = "finalizeSubmission();"
              class = "form-control"
              />
        Submit
      </button>
    </div>
  </div>
</div>


<script>
  /* global api, swal, urcpp */
  api = urcpp("v1");
  
  function handleResponse (data) {
    if (data.response == "OK") {
      window.location.href = window.location.href = api.next();
    } else {
     
      swal({  title: "Please contact " + urcpp.constants.alertEmail,   
              text: data["details"],   
              type: "error",   
              confirmButtonText: "Uh-Oh." 
      });
    }
  };
  
  function finalizeSubmission() {
    console.log("Finalizing application");
    api.set.finalize(username, handleResponse); 
    api.go();
  };
</script>

{% endblock %}
